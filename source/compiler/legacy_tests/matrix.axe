def print_matrix(m: int[rows][cols], rows: int, cols: int) {
    mut r: int = 0;
    loop {
        if r >= rows {
            break;
        }

        mut c: int = 0;
        loop {
            if c >= cols {
                break;
            }

            print m[r][c];
            print " ";
            c = c + 1;
        }

        println "";
        r = r + 1;
    }
}

def matmul(a: int[n][m], b: int[m][p], result: int[n][p], n: int, m: int, p: int) {
    // a: n × m
    // b: m × p
    // result: n × p

    mut r: int = 0;
    loop {
        if r >= n {
            break;
        }

        mut c: int = 0;
        loop {
            if c >= p {
                break;
            }

            mut sum: int = 0;

            mut k: int = 0;
            loop {
                if k >= m {
                    break;
                }

                sum = sum + (a[r][k] * b[k][c]);
                k = k + 1;
            }

            result[r][c] = sum;
            c = c + 1;
        }

        r = r + 1;
    }
}

def main() {
    // Multiply:
    // [1 2 3]   [1 2]
    // [4 5 6] x [3 4]
    //           [5 6]

    val n: int = 2;
    val m: int = 3;
    val p: int = 2;

    mut A: int[2][3];
    mut B: int[3][2];
    mut R: int[2][2];

    // Fill A
    A[0][0] = 1; A[0][1] = 2; A[0][2] = 3;
    A[1][0] = 4; A[1][1] = 5; A[1][2] = 6;

    // Fill B
    B[0][0] = 1; B[0][1] = 2;
    B[1][0] = 3; B[1][1] = 4;
    B[2][0] = 5; B[2][1] = 6;

    // Multiply
    matmul(A, B, R, n, m, p);

    println "Result:";
    print_matrix(R, n, p);
}
